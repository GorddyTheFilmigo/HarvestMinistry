{% extends "base.html" %}
{% block title %}Evangelism Resources | The Lord's Harvest Ministry{% endblock %}

{% block content %}
<style>
  :root {
    --ministry-primary: #1e3a8a;
    --ministry-secondary:: #3b82f6;
    --ministry-gold: #f59e0b;
    --ministry-red: #dc2626;
    --ministry-purple: #7c3aed;
    --ministry-light: #eff6ff;
    --text-dark: #1f2937;
    --text-muted: #6b7280;
    --border-color: #e5e7eb;
    --bg-light: #f9fafb;
  }

  /* Hero Banner */
  .evangelism-hero {
    background: linear-gradient(135deg, var(--ministry-primary) 0%, #1e40af 100%),
                url('{{ url_for("static", filename="images/hero.jpg") }}') center/cover no-repeat;
    color: white;
    padding: 100px 20px 80px;
    text-align: center;
    position: relative;
    overflow: hidden;
  }
  .evangelism-hero::before {
    content: '';
    position: absolute;
    inset: 0;
    background: rgba(0, 0, 0, 0.4);
  }
  .hero-content {
    position: relative;
    z-index: 2;
    max-width: 900px;
    margin: 0 auto;
  }
  .hero-content h1 {
    font-size: 3rem;
    font-weight: 800;
    margin-bottom: 16px;
    text-shadow: 0 4px 12px rgba(0,0,0,0.4);
  }
  .hero-content p {
    font-size: 1.3rem;
    opacity: 0.95;
    max-width: 700px;
    margin: 0 auto 30px;
  }

  /* Live Stream Button */
  .live-stream-btn {
    display: inline-flex;
    align-items: center;
    gap: 12px;
    background: linear-gradient(135deg, var(--ministry-red) 0%, #b91c1c 100%);
    color: white;
    font-weight: 700;
    padding: 16px 36px;
    border-radius: 50px;
    text-decoration: none;
    font-size: 1.15rem;
    box-shadow: 0 8px 20px rgba(220, 38, 38, 0.35);
    transition: all 0.3s ease;
    border: 2px solid rgba(255,255,255,0.2);
  }
  .live-stream-btn:hover {
    transform: translateY(-4px);
    box-shadow: 0 16px 32px rgba(220, 38, 38, 0.45);
  }
  .live-dot {
    width: 14px; height: 14px;
    background: #fca5a5;
    border-radius: 50%;
    animation: livePulse 2s infinite;
  }
  @keyframes livePulse {
    0%, 100% { box-shadow: 0 0 0 0 rgba(252, 165, 165, 0.7); }
    50% { box-shadow: 0 0 0 10px rgba(252, 165, 165, 0); }
  }

  /* Youth Admin Panel Card */
  .youth-admin-card {
    background: linear-gradient(135deg, #7c3aed 0%, #a78bfa 100%);
    color: white;
    padding: 40px;
    border-radius: 20px;
    text-align: center;
    box-shadow: 0 15px 40px rgba(124, 58, 237, 0.3);
    margin: 40px auto;
    max-width: 1000px;
  }
  .youth-admin-card h3 {
    font-size: 2.2rem;
    margin-bottom: 12px;
  }
  .youth-admin-card p {
    font-size: 1.15rem;
    opacity: 0.95;
    margin-bottom: 28px;
  }
  .youth-admin-btn {
    background: white;
    color: #7c3aed;
    font-weight: 700;
    padding: 18px 50px;
    border-radius: 50px;
    font-size: 1.3rem;
    text-decoration: none;
    display: inline-block;
    box-shadow: 0 10px 30px rgba(0,0,0,0.25);
    transition: all 0.4s ease;
  }
  .youth-admin-btn:hover {
    transform: translateY(-5px);
    box-shadow: 0 20px 40px rgba(0,0,0,0.35);
  }

  /* Upload Section */
  .upload-section {
    background: white;
    padding: 40px;
    border-radius: 16px;
    box-shadow: 0 8px 25px rgba(0,0,0,0.08);
    border: 1px solid var(--border-color);
    max-width: 700px;
    margin: 40px auto;
  }
  .upload-section h2 {
    text-align: center;
    font-size: 1.9rem;
    color: var(--ministry-primary);
    margin-bottom: 10px;
  }
  .upload-section p {
    text-align: center;
    color: var(--text-muted);
    margin-bottom: 30px;
  }
  .form-group {
    margin-bottom: 20px;
  }
  .form-group label {
    font-weight: 600;
    color: var(--text-dark);
    display: block;
    margin-bottom: 8px;
  }
  select, input[type="file"] {
    width: 100%;
    padding: 14px;
    border: 2px solid var(--border-color);
    border-radius: 10px;
    font-size: 1rem;
  }
  .upload-btn {
    background: var(--ministry-primary);
    color: white;
    width: 100%;
    padding: 16px;
    border: none;
    border-radius: 12px;
    font-size: 1.1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s;
  }
  .upload-btn:hover {
    background: #1e40af;
    transform: translateY(-2px);
  }

  /* Section Headers */
  .section-header {
    display: flex;
    align-items: center;
    gap: 16px;
    margin: 50px 0 30px;
    padding-bottom: 12px;
    border-bottom: 2px solid var(--border-color);
  }
  .section-header span {
    font-size: 2.5rem;
  }
  .section-header h3 {
    font-size: 1.8rem;
    color: var(--ministry-primary);
    margin: 0;
    font-weight: 700;
  }
  .section-count {
    margin-left: auto;
    background: var(--ministry-light);
    color: var(--ministry-primary);
    padding: 6px 14px;
    border-radius: 20px;
    font-weight: 600;
    font-size: 0.9rem;
  }

  /* Resources Grid */
  .resources-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
    gap: 28px;
    margin-bottom: 50px;
  }
  .resource-card {
    background: white;
    border-radius: 16px;
    overflow: hidden;
    box-shadow: 0 6px 20px rgba(0,0,0,0.08);
    border: 1px solid var(--border-color);
    transition: all 0.3s ease;
  }
  .resource-card:hover {
    transform: translateY(-8px);
    box-shadow: 0 16px 35px rgba(0,0,0,0.14);
  }
  .resource-thumb {
    height: 180px;
    background: var(--bg-light);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 4.5rem;
    opacity: 0.7;
  }
  .resource-thumb img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }
  .resource-content {
    padding: 24px;
  }
  .resource-content h4 {
    margin: 0 0 12px;
    font-size: 1.25rem;
    color: var(--text-dark);
    font-weight: 600;
  }
  .resource-actions {
    display: flex;
    gap: 10px;
    margin-top: 16px;
  }
  .btn {
    flex: 1;
    padding: 12px;
    border-radius: 10px;
    text-align: center;
    font-weight: 600;
    font-size: 0.95rem;
    text-decoration: none;
    transition: all 0.3s;
  }
  .btn-view { background: var(--ministry-secondary); color: white; }
  .btn-view:hover { background: #2563eb; }
  .btn-download { background: #16a34a; color: white; }
  .btn-download:hover { background: #15803d; }
  .btn-delete {
    background: #ef4444;
    color: white;
    padding: 12px 16px;
    border-radius: 10px;
  }
  .btn-delete:hover { background: #dc2626; }

  audio, video {
    width: 100%;
    border-radius: 10px;
    margin: 12px 0;
  }

  .empty-state {
    text-align: center;
    padding: 60px 20px;
    color: var(--text-muted);
    font-size: 1.1rem;
    background: var(--ministry-light);
    border-radius: 16px;
    border: 2px dashed var(--border-color);
  }

  @media (max-width: 768px) {
    .evangelism-hero h1 { font-size: 2.3rem; }
    .resources-grid { grid-template-columns: 1fr; }
    .section-header { flex-direction: column; text-align: center; gap: 10px; }
    .section-count { margin: 10px auto 0; }
  }
</style>

<!-- Hero -->
<section class="evangelism-hero">
  <div class="hero-content">
    <h1>Evangelism Resources</h1>
    <p>Powerful tools to equip you for sharing the Gospel with boldness and clarity</p>
    <a href="{{ url_for('stream_control') }}" class="live-stream-btn">
      <span class="live-dot"></span> Watch Live Stream
    </a>
  </div>
</section>

<div class="container" style="max-width: 1300px; margin: 0 auto; padding: 0 20px;">

  <!-- Youth Ministry Admin Panel -->
  <div class="youth-admin-card">
    <h3>Manage Children & Youth Ministry</h3>
    <p>Add leaders • Upload teaching photos • Schedule events & programs</p>
    <a href="{{ url_for('admin_youth_ministry') }}" class="youth-admin-btn">
      Open Youth Ministry Panel
    </a>
  </div>

  <!-- Upload Form -->
  <div class="upload-section">
    <h2>Upload New Resources</h2>
    <p>Share PDFs, audio sermons, videos, or images for evangelism training</p>
    <form action="{{ url_for('upload_resources') }}" method="post" enctype="multipart/form-data">
      <div class="form-group">
        <label>Resource Type</label>
        <select name="file_type" required>
          <option value="">-- Choose Type --</option>
          <option value="documents">Documents (PDF, DOCX, etc.)</option>
          <option value="audio">Audio Messages</option>
          <option value="video">Video Teachings</option>
          <option value="images">Images (for Youth Ministry)</option>
        </select>
      </div>
      <div class="form-group">
        <label>Choose Files (multiple allowed)</label>
        <input type="file" name="files" multiple required>
      </div>
      <button type="submit" class="upload-btn">Upload Resources</button>
    </form>
  </div>

  <!-- Documents -->
  <div class="section-header">
    <span>Documents</span>
    <h3>Study Materials & Tracts</h3>
    <span class="section-count">{{ files.documents|length }} files</span>
  </div>
  {% if files.documents %}
  <div class="resources-grid">
    {% for file in files.documents %}
    <div class="resource-card">
      <div class="resource-thumb">Document</div>
      <div class="resource-content">
        <h4>{{ file }}</h4>
        <div class="resource-actions">
          <a href="{{ url_for('serve_document', filename=file) }}" target="_blank" class="btn btn-view">View</a>
          <a href="{{ url_for('serve_document', filename=file) }}" download class="btn btn-download">Download</a>
          <a href="{{ url_for('delete_file', file_type='documents', filename=file) }}"
             onclick="return confirm('Delete this document?')" class="btn-delete">Delete</a>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
  {% else %}
  <div class="empty-state">No documents uploaded yet</div>
  {% endif %}

  <!-- Audio -->
  <div class="section-header">
    <span>Audio</span>
    <h3>Audio Teachings</h3>
    <span class="section-count">{{ files.audio|length }} files</span>
  </div>
  {% if files.audio %}
  <div class="resources-grid">
    {% for file in files.audio %}
    <div class="resource-card">
      <div class="resource-thumb">Audio</div>
      <div class="resource-content">
        <h4>{{ file }}</h4>
        <audio controls><source src="{{ url_for('serve_audio', filename=file) }}"></audio>
        <div class="resource-actions">
          <a href="{{ url_for('serve_audio', filename=file) }}" target="_blank" class="btn btn-view">Listen</a>
          <a href="{{ url_for('serve_audio', filename=file) }}" download class="btn btn-download">Download</a>
          <a href="{{ url_for('delete_file', file_type='audio', filename=file) }}" class="btn-delete"
             onclick="return confirm('Delete this audio?')">Delete</a>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
  {% else %}
  <div class="empty-state">No audio messages uploaded yet</div>
  {% endif %}

  <!-- Video -->
  <div class="section-header">
    <span>Video</span>
    <h3>Video Resources</h3>
    <span class="section-count">{{ files.video|length }} files</span>
  </div>
  {% if files.video %}
  <div class="resources-grid">
    {% for file in files.video %}
    <div class="resource-card">
      <div class="resource-thumb">Video</div>
      <div class="resource-content">
        <h4>{{ file }}</h4>
        <video controls><source src="{{ url_for('serve_video', filename=file) }}"></video>
        <div class="resource-actions">
          <a href="{{ url_for('serve_video', filename=file) }}" target="_blank" class="btn btn-view">Watch</a>
          <a href="{{ url_for('serve_video', filename=file) }}" download class="btn btn-download">Download</a>
          <a href="{{ url_for('delete_file', file_type='video', filename=file) }}" class="btn-delete"
             onclick="return confirm('Delete this video?')">Delete</a>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
  {% else %}
  <div class="empty-state">No videos uploaded yet</div>
  {% endif %}

  <!-- Images (Only for Youth Ministry - still visible in admin) -->
  <div class="section-header">
    <span>Images</span>
    <h3>Youth Ministry Images</h3>
    <span class="section-count">{{ files.images|length }} images</span>
  </div>
  <div class="resources-grid">
    {% if files.images %}
      {% for file in files.images %}
      <div class="resource-card">
        <div class="resource-thumb">
          <img src="{{ url_for('serve_image', filename=file) }}" alt="Youth Image">
        </div>
        <div class="resource-content">
          <h4>{{ file }}</h4>
          <div class="resource-actions">
            <a href="{{ url_for('serve_image', filename=file) }}" target="_blank" class="btn btn-view">View</a>
            <a href="{{ url_for('serve_image', filename=file) }}" download class="btn btn-download">Download</a>
            <a href="{{ url_for('delete_file', file_type='images', filename=file) }}" class="btn-delete"
               onclick="return confirm('Delete this image?')">Delete</a>
          </div>
        </div>
      </div>
      {% endfor %}
    {% else %}
      <div class="empty-state">No images uploaded yet — these will appear in Children & Youth Ministry</div>
    {% endif %}
  </div>

</div>
{% endblock %}